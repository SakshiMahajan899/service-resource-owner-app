<mat-card>
  <mat-card-title>ðŸ”§ Edit Service by ID</mat-card-title>

  <!-- Step 1: Enter Service ID -->
  <form (ngSubmit)="loadService()" #loadForm="ngForm">
    <mat-form-field appearance="fill">
      <mat-label>Enter Service ID</mat-label>
      <input matInput [(ngModel)]="enteredId" name="enteredId" required />
    </mat-form-field>
    <button mat-raised-button color="primary" type="submit">Fetch & Edit</button>
  </form>

  <mat-divider style="margin: 1rem 0;"></mat-divider>

  <!-- Step 2: Display Form If Service Is Loaded -->
  <form *ngIf="service" #updateForm="ngForm">
    <p><strong>Service ID:</strong> {{ service.id }}</p>

    <!-- Resources -->
    <div *ngFor="let resource of service.resources; let resIdx = index">
      <mat-divider></mat-divider>
      <mat-card-subtitle>Resource {{ resIdx + 1 }}</mat-card-subtitle>

      <mat-form-field appearance="fill">
        <mat-label>Resource ID</mat-label>
        <input
                matInput
                [(ngModel)]="resource.id"
                name="resourceId{{ resIdx }}"
                required
                disabled
        />
      </mat-form-field>

      <!-- Owners -->
      <div *ngFor="let owner of resource.owners; let ownerIdx = index">
        <mat-card-subtitle>Owner {{ ownerIdx + 1 }}</mat-card-subtitle>

        <mat-form-field appearance="fill">
          <mat-label>Owner ID</mat-label>
          <input
                  matInput
                  [(ngModel)]="owner.id"
                  name="ownerId{{ resIdx }}_{{ ownerIdx }}"
                  required
                  disabled
          />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Owner Name</mat-label>
          <input
                  matInput
                  [(ngModel)]="owner.name"
                  name="ownerName{{ resIdx }}_{{ ownerIdx }}"
                  required
          />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Account Number</mat-label>
          <input
                  matInput
                  [(ngModel)]="owner.accountNumber"
                  name="accountNumber{{ resIdx }}_{{ ownerIdx }}"
                  required
          />
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Level</mat-label>
          <input
                  matInput
                  type="number"
                  [(ngModel)]="owner.level"
                  name="ownerLevel{{ resIdx }}_{{ ownerIdx }}"
                  required
          />
        </mat-form-field>
      </div>

      <button mat-stroked-button color="accent" type="button" (click)="addOwner(resIdx)">
        + Add Owner
      </button>
    </div>

    <button mat-stroked-button color="accent" type="button" (click)="addResource()">
      + Add Resource
    </button>

    <div style="margin-top: 1rem">
      <button mat-raised-button color="primary" (click)="updateService()" type="button">
        Update Service
      </button>
      <button mat-button type="button" (click)="cancel()">Cancel</button>
    </div>
  </form>
</mat-card>
